\documentclass[10pt]{article}

  \usepackage{pgfplots}
\pgfplotsset{compat=newest}
%% the following commands are needed for some matlab2tikz features
\usetikzlibrary{plotmarks}
\usetikzlibrary{arrows.meta}
\usepgfplotslibrary{patchplots}
\usepackage{grffile}
\usepackage{amsmath}


%\usepackage{fullpage}
\usepackage[top=1in, bottom=1in, left=0.8in, right=1in]{geometry}
\usepackage{multicol}
%\usepackage{wrapfig}
%\usepackage{listings}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{xcolor}
%\usepackage{soul}
\usepackage{graphicx}
\usepackage[pdf]{pstricks}

\definecolor{lightblue}{rgb}{.80,.9,1}
\newcommand{\hl}[1]
    {\par\colorbox{lightblue}{\parbox{\linewidth}{#1}}}

\newcommand{\defn}{\stackrel{\textrm{\scriptsize def}}{=}}

\setlength{\columnsep}{0.1pc}

\title{Generalised Serre-Green-Naghdi Model}
%\author{Christopher Zoppou -- \texttt{christopher.zoppou@anu.edu.au}, Dimitrios Mitsotakis -- \texttt{dmitsot@gmail.com}, Stephen Roberts -- \texttt{stephen.roberts@anu.edu.au}, Jordan Pitt}

% TIME ON EVERY PAGE AS WELL AS THE FILE NAME
\usepackage{fancyhdr}
\usepackage{currfile}
\usepackage[us,12hr]{datetime} % `us' makes \today behave as usual in TeX/LaTeX
\fancypagestyle{plain}{
\fancyhf{}
\rfoot{\emph{\footnotesize \textcopyright  Serre Notes by C. Zoppou, D. Mitsatakis and S. Roberts.}
 \\ File Name: {\currfilename} \\ Date: {\ddmmyyyydate\today} at \currenttime}
\lfoot{Page \thepage}
\renewcommand{\headrulewidth}{0pt}}
\pagestyle{plain}

\begin{document}

\maketitle

\vspace{-0.3in}
\noindent
\rule{\linewidth}{0.4pt}

%-------------------------------------------------
%\section{Introduction}
%-------------------------------------------------



%-------------------------------------------------
\section{gSGN - generalised Serre-Green-Naghdi equations}
%-------------------------------------------------
Clamond and Dutykh\cite{Clamond-Dutykh-2018-237} derived the following generalised version of the Serre-Green-Naghdi equations:

\begin{subequations}
	\begin{gather}
	\dfrac{\partial h}{\partial t} + \dfrac{\partial (uh)}{\partial x} = 0
	\label{eq:gSGNh}
	\end{gather}
	\begin{gather}
	\dfrac{\partial (uh)}{\partial t} + \dfrac{\partial }{\partial x} \left( u^2h + \dfrac{gh^2}{2} + \frac{1}{3} h^2 \Gamma \right)= 0
	\label{eq:gSGNuh}
	\end{gather}
	\begin{multline}
	\dfrac{\partial}{\partial t}\left[\frac{1}{2}hu^2 + \dfrac{1}{2}\left(1 + \frac{3}{2}\beta_1\right) h^3 \dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x} + \frac{1}{2}gh^2\left(1 + \frac{1}{2}\beta_2 \dfrac{\partial h}{\partial x} \dfrac{\partial h}{\partial x}\right) \right] \\
	\dfrac{\partial}{\partial x}\left[uh\left(\frac{1}{2}u^2 + \dfrac{1}{2}\left(1 + \frac{3}{2}\beta_1\right)h^2\dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x} + gh\left(1 + \frac{1}{4}\beta_2\dfrac{\partial h}{\partial x}\dfrac{\partial h}{\partial x} \right)   + \frac{1}{3} h\Gamma  \right) + \frac{1}{2}\beta_2 g h^3\dfrac{\partial h}{\partial x}\dfrac{\partial u}{\partial x} \right]
	=0
	\label{eq:gSGNE}
	\end{multline}
	where
	\begin{equation}
	\Gamma = \left(1 + \frac{3}{2}\beta_1\right)h \left[\frac{\partial u}{\partial x}\frac{\partial u}{\partial x} - \frac{\partial^2 u}{\partial x \partial t} - u\frac{\partial^2 u}{\partial x^2}\right] - \frac{3}{2} \beta_2 g\left[h \frac{\partial^2 h}{\partial x^2} + \frac{1}{2} \frac{\partial h}{\partial x}\frac{\partial h}{\partial x} \right]
	\end{equation}
	\label{eq:gSGN}
\end{subequations}

These equations have the same order of approximation in the lagrangian density (dispersion properties?) when $\beta_1 = \beta_2$. The interesting thing about the equations though, is that we will conserve mass, momentum and energy for all values of $\beta_j$. 

From these equations the SWWE, the Serre equations and the regularised SWWE \cite{Clamond-Dutykh-2018-237} can be recovered for certain values of $\beta_1$ and $\beta_2$. 

%\begin{itemize}
%	\item When $\beta_1 = 2\epsilon -\frac{2}{3}$ and $\beta_2 = 2 \epsilon$ we get the regularised Saint Venant equations of \cite{Clamond-Dutykh-2018-237}. Which admit the SWWE when $\epsilon = 0$. 
%	\item When $\beta_1 = \beta_2$ we get the improved Serre-Green-Naghdi equations, which when $\beta_1 =\beta_2 = 0$ are the Serre-Green-Naghdi equations. 
%\end{itemize}

\begin{table}
	\centering
	\begin{tabular}{c | c | c}
		Resulting Equations &$\beta_1$ & $\beta_2$  \\
		\hline 
		Serre Equations & $0$ & $0$ \\
		SWWE Equations & $-\dfrac{2}{3}$ & $0$ \\
		Regularised SWWE Equations & free variable & $\beta_1 + \dfrac{2}{3}$  \\
		Improved Dispersion Serre Equations & free variable & $\beta_1$
	\end{tabular}
	\caption{Showing various combinations of $\beta$ values and equivalent equations}
\end{table}

%-------------------------------------------------
\subsection{Alternative Conservative Form of the gSGN}
%-------------------------------------------------

A major difficulty with solving the SGN is that the dispersive terms contain a mixed spatial-temporal derivative term which is difficult to handle numerically. This mixed derivative term can be rewritten  so that the Serre equations can be expressed in conservation law form, with the water depth and a new quantity as conservative variables. This reformulation allows standard techniques for solving conservation laws to be applied to the Serre equations, even though the Serre equations are neither hyperbolic nor parabolic.

Consider the Serre equations written for a horizontal bed. The flux term in the momentum equation, \eqref{eq:gSGNuh} contains a mixed spatial and temporal derivative term which is difficult to treat numerically. It is possible to replace this term  by a combination of spatial and temporal derivative terms by making the following observation
\begin{multline}
\dfrac{\partial^2}{\partial x \partial t} \left ( \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) h^3 \dfrac{\partial u}{\partial x} \right ) =   \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) \dfrac{\partial }{\partial t} \left ( 3h^2 \dfrac{\partial h}{\partial x} \dfrac{\partial u}{\partial x} + h^3 \dfrac{\partial^2 u}{\partial x^2} \right ) \\=  \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right)
\dfrac{\partial }{\partial x} \left ( 3 h^2 \dfrac{\partial h}{\partial t} \dfrac{\partial u}{\partial x} + h^3 \dfrac{\partial^2 u}{\partial x \partial t} \right ).
\end{multline}
Rearranging and making use of the continuity equation, \eqref{eq:gSGNh} the momentum equation, \eqref{eq:gSGNuh} becomes
\begin{multline}
\dfrac{\partial }{\partial t} \left ( u h -  \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) \dfrac{\partial}{\partial x} \left [h^3 \dfrac{\partial u}{\partial x}  \right ] \right ) \\ + \dfrac{\partial}{\partial x} \left ( u\left[uh - \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) \dfrac{\partial }{\partial x} \left [ h^3 \dfrac{\partial u}{\partial x} \right ]\right] + \dfrac{gh^2}{2} - \frac{2}{3}\left(1 + \frac{3}{2} \beta_1\right) h^3\dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x}  - \frac{1}{2} \beta_2 g h^2 \left[h\frac{\partial^2 h}{\partial x^2} + \frac{1}{2}\frac{\partial h}{\partial x}\frac{\partial h}{\partial x}\right]\right ) = 0.
\end{multline}
The momentum equation can be written in conservation law form as
\begin{gather}\label{eq:G_momentum}
\dfrac{\partial G }{\partial t}  + \dfrac{\partial}{\partial x} \left ( uG + \dfrac{gh^2}{2} - \frac{2}{3}\left(1 + \frac{3}{2} \beta_1\right) h^3\dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x}  - \frac{1}{2} \beta_2 g h^2  \left[h\frac{\partial^2 h}{\partial x^2} + \frac{1}{2}\frac{\partial h}{\partial x}\frac{\partial h}{\partial x}\right]\right ) = 0.
\end{gather}
where a new conserved quantity, $G$ is given by
\begin{gather*}
G = uh - \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) \dfrac{\partial }{\partial x} \left ( h^3 \dfrac{\partial u}{\partial x} \right ).
\end{gather*}
This expands the conserved variable introduced by \cite{Clamond-Dutykh-2018-237}, as well as in the Serre equations []. 

Thus we have the following conservation equations

\begin{subequations}
\begin{gather}
\dfrac{\partial h}{\partial t} + \dfrac{\partial (uh)}{\partial x} = 0
\label{eq:gSGN_Gh}
\end{gather}
\begin{gather}
\dfrac{\partial G }{\partial t}  + \dfrac{\partial}{\partial x} \left ( uG + \dfrac{gh^2}{2} - \frac{2}{3}\left(1 + \frac{3}{2} \beta_1\right) h^3\dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x}  - \frac{1}{2} \beta_2 g h^2  \left[h\frac{\partial^2 h}{\partial x^2} + \frac{1}{2}\frac{\partial h}{\partial x}\frac{\partial h}{\partial x}\right]\right ) = 0.
\label{eq:gSGN_GG}
\end{gather}
with
\begin{gather}\label{eq:G_divergent}
G = uh - \frac{1}{3}\left(1 + \frac{3}{2} \beta_1\right) \dfrac{\partial }{\partial x} \left ( h^3 \dfrac{\partial u}{\partial x} \right ).
\end{gather}
\end{subequations}

\subsection{Dispersion Relation of Linearised gSGN}

Assuming that
\begin{align*}
h(x,t) &= h_0 + \delta \eta(x,t) + O(\delta^2)\\
u(x,t) &= u_0 + \delta v(x,t) + O(\delta^2)
\end{align*}

By substituting these forms into the linearised Serre equations and neglecting $O(\delta^2)$ terms, we get the linearised regularised Serre equations. We also substitute $\eta_t$ using the mass equation into the momentum equation. 


\begin{subequations}
	\begin{equation}
	\label{eqlinhd}
	(\delta\eta)_t + u_0 (\delta \eta)_x + h_0 (\delta v)_x = 0
	\end{equation}
	\begin{equation}
	\label{eqlinuhd}
	h_0(\delta v)_t + gh_0(\delta \eta)_x + h_0u_0 (\delta v)_x - \frac{1}{3}\left(1 + \frac{3}{2}\beta_1\right) h_0^3(\delta v)_{xxt} - \frac{1}{3}\left(1 + \frac{3}{2}\beta_1\right) h_0^3 u_0 (\delta v)_{xxx} -\frac{g\beta_2}{2}h_0^3 (\delta \eta)_{xxx}  = 0
	\end{equation}
\end{subequations}

We can remove the $\delta$ term, either by removing the common factor, or absorbing it into $\eta$ and $v$ to get

\begin{subequations}
	\begin{equation}
	\label{eqlinh}
	\eta_t + u_0 \eta_x + h_0 v_x = 0
	\end{equation}
	\begin{equation}
	\label{eqlinuh}
	h_0(v)_t + gh_0(\eta)_x + h_0u_0 (v)_x - \frac{1}{3}\left(1 + \frac{3}{2}\beta_1\right) h_0^3(v)_{xxt} - \frac{1}{3}\left(1 + \frac{3}{2}\beta_1\right) h_0^3 u_0 ( v)_{xxx} -\frac{g\beta_2}{2}h_0^3 (\eta)_{xxx}  = 0
	\end{equation}
\end{subequations}

We now assume that $\eta(x,t) = H \exp\left(i (k x - \omega t)\right)$,  $v(x,t) = U \exp\left(i (k x - \omega t)\right)$
\begin{align*}
\eta(x,t) &= H \exp\left(i (k x - \omega t)\right) \\
v(x,t) &= U \exp\left(i (k x - \omega t)\right)
\end{align*}

substituting these into the linearised Serre equation we get

\begin{subequations}
	\begin{equation}
	\label{eqlinhexp}
	\left[H u_0 k - H \omega + U h_0k\right]i \exp\left[i \left(k x - \omega t\right)\right] = 0
	\end{equation}
	\begin{multline}
	\label{eqlinuhexp}
	\bigg[3H \beta_2 g h_0^2 k^3 + 6Hgk - 3U \beta_1 \omega h_0^2 k^2 + 3U\beta_1 h_0^2 k^3 u_0\\ - 2U \omega h_0^2 k^2 - 6U \omega + 2U h_0^2 k^3 u_0 + 6U k u_0\bigg] i \frac{h_0}{6} \exp\left[i \left(k x - \omega t\right)\right] = 0
	\end{multline}
\end{subequations}


This can be written as
\begin{equation}
\begin{bmatrix}
u_0k - \omega & h_0 k \\
3 \beta_2 h_0^2 k^3 + 6k g & -3 \beta_1 \omega h_0^2 k^2 + 3 \beta_1 h_0^2 k^3 u_0 - 2\omega h_0^2 k^2 - 6\omega + 2h_0^2 k^3 u_0 + 6ku_0
\end{bmatrix}
\begin{bmatrix}
H \\ U
\end{bmatrix} = 0
\end{equation}

Which has non-trivial solutons when the determinant is zero. 

The determinant of this matrix is
\begin{equation}
\left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)\omega^2 - 2 u_0k \left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)\omega  + u_0^2 k^2 \left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right) - g h_0 k^2 \left(3 \beta_2 h_0^2 k^2 + 6\right)
\end{equation} 

To get non-trivial solution we have

\begin{equation}
\left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)\omega^2 - 2 u_0k \left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)\omega  + u_0^2 k^2 \left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right) - g h_0 k^2 \left(3 \beta_2 h_0^2 k^2 + 6\right) = 0
\end{equation} 

\begin{equation}
\omega^2 - 2 u_0k \omega  + u_0^2 k^2 - g h_0 k^2 \dfrac{3 \beta_2 h_0^2 k^2 + 6}{\left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)} 
\end{equation} 

Using quadratic equation, or another quadratic polynomial solver we get that

\begin{equation}
\omega^\pm = u_0 k \pm k \sqrt{gh_0} \sqrt{\dfrac{3 \beta_2 h_0^2 k^2 + 6}{\left(3\beta_1 h_0^2 k^2 + 2h_0^2 k^2 + 6\right)} }
\end{equation}

\begin{equation}
\omega^\pm = u_0 k \pm k \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2} }
\end{equation}


Thus we have the following regimes
\begin{itemize}
	\item SWWE wavespeeds (non-dispersive): occurs when $\beta_2 = \frac{2}{3} + \beta_1$ then $\omega^\pm = k\left(u_0\pm \sqrt{gh_0}\right)$ (\cite{Clamond-Dutykh-2018-237}).
	\item Serre wavespeeds - when $\beta_1 = \beta_2 = 0$ - we get $\omega^\pm = k\left(u_0\pm \sqrt{gh_0} \sqrt{\dfrac{3}{3 + h_0^2 k^2}}\right)$
	\item For other values of $\beta_1$ and $\beta_2$ we can vary the wavespeeds, in certain situations this will lead to a better approximation of the linear wavespeed of waves than the Serre equations ( \cite{Clamond-Dutykh-2018-237}), in others it will be worse. We show an example below.
\end{itemize}

Now for the group speed
\begin{equation}
v^\pm_g = \frac{\partial \omega^\pm }{\partial k}= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm \dfrac{k\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left( \beta_2 h_0^2 k - \dfrac{h_0^2 k \left(\beta_1 + \frac{2}{3}\right)\left(\beta_2h_0^2k^2 + 2\right)}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{equation} 

\begin{multline*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm \\ \dfrac{k\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left(  \dfrac{\beta_2 h_0^2 k^2 \left[h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2\right] -h_0^2 k \left(\beta_1 + \frac{2}{3}\right)\left(\beta_2h_0^2k^2 + 2\right)}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{multline*} 

\begin{multline*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm \\ \dfrac{k\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left(  \dfrac{  \beta_2 h_0^4 k^3 \left(\beta_1 + \frac{2}{3}\right)  + 2\beta_2 h_0^2 k -h_0^2 k \left(\beta_1 + \frac{2}{3}\right)\left(\beta_2h_0^2k^2 + 2\right)}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{multline*} 

\begin{multline*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm \\ \dfrac{k\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left(  \dfrac{  \beta_2 h_0^4 k^3 \left(\beta_1 + \frac{2}{3}\right)  + 2\beta_2 h_0^2 k -  \beta_2\left(\beta_1 + \frac{2}{3}\right)h_0^4k^3 -    2 h_0^2 k \left(\beta_1 + \frac{2}{3}\right)}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{multline*} 


\begin{multline*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm \\ \dfrac{k\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left(  \dfrac{  2\beta_2 h_0^2 k  -    2 h_0^2 k \left(\beta_1 + \frac{2}{3}\right)}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{multline*} 

\begin{multline*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \pm  2\dfrac{k^2h_0^2\sqrt{gh_0}}{\beta_2 h_0^2 k^2 +2} \left[\sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left(  \dfrac{\beta_2  -    \beta_1 - \frac{2}{3}}{h_0^2 k^2 \left(\beta_1 + \frac{2}{3}\right) + 2} \right)\right]
\end{multline*} 

\begin{equation*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} } \left[1 +  \dfrac{\beta_2 - \beta_1 - \frac{2}{3}}{\left(\frac{1}{2}\beta_2 h_0^2 k^2 +1\right)\left( \left(\frac{1}{3} + \beta_1\right) h_0^2 k^2 + 1\right)}\right] 
\end{equation*} 


When $\beta_2 = \frac{2}{3} + \beta_1$ then the group speed is equal to the phase speed of the Shallow Water Wave equations. When $\beta_2 = \beta_1 = 0$ then we get

\begin{equation*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{2}{\left( \frac{2}{3} h_0^2 k^2 + 2\right)} } \left[1 + \dfrac{- \frac{1}{3}}{\left( \frac{1}{3} h_0^2 k^2 + 1\right)}\right] 
\end{equation*} 

\begin{equation*}
= u_0  \pm  \sqrt{gh_0} \sqrt{\dfrac{3}{  h_0^2 k^2 + 3} } \left[1 -  \dfrac{1}{ h_0^2 k^2 + 3}\right] 
\end{equation*} 

which matches [Zoppo,pitt,paper on FDVM methods for Serre equations / Chris thesis]


\subsubsection{Wave Speed Bounds}

First we want to show that phase and group speed are bounded, when treated as functions of $k$.
The phase speed is:
\begin{equation}
v^\pm_p = \frac{\omega^\pm}{k}=u_0 \pm  \sqrt{gh_0} \sqrt{\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)} }
\end{equation} 

So we need to demonstrate that $\exists \alpha$ s.t  $\forall k$

\begin{equation}
\dfrac{\beta_2 h_0^2 k^2 + 2}{ \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2} \le \alpha
\end{equation}

This is equivalent to showing that $\exists \alpha$ s.t  $\forall \mu$
\begin{equation}
\dfrac{a \mu^2 + 1}{ b\mu^2  + 1} \le \alpha
\end{equation}

One such bound is simple enough to get and that is when $\alpha = \max\left\lbrace 1,\frac{a}{b} \right\rbrace$ when $b \neq 0$ and $\alpha = \max\left\lbrace1, a \mu^2 + 1\right\rbrace$ when $b = 0$. So if $b = 0$ and $a \neq 0$ then the wavespeeds are no longer bounded. Thus we must restrict our numerical method to only allow $\beta_1 = -\frac{2}{3}$ only when $\beta_2 = 0$. Note that the regularised SWWE and the Serre equations fall under this condition (all our problems of interest) so its ok that our method is not appropriate for the condition.

Additionally for $\beta_1 \ge -\frac{2}{3}$ and $\beta_2 \ge 0$ we have that 

\begin{equation}
\dfrac{\beta_2 h_0^2 k^2 + 2}{\left( \left(\frac{2}{3} + \beta_1\right) h_0^2 k^2 + 2\right)}
\end{equation}

is a montone function in terms of $h_0k$, it is monotone decreasing if $\beta_2 \le \frac{2}{3} + \beta_1$ and monotone increasing if $\beta_2 \ge \frac{2}{3} + \beta_1$.
 
We have the following limits

as $k \rightarrow 0$
\begin{equation}
 v^\pm_p = u_0 \pm \sqrt{gh_0}
\end{equation} 

as $k \rightarrow \infty$
\begin{equation}
v^\pm_p = u_0 \pm \sqrt{gh_0} \sqrt{\dfrac{\beta_2}{\frac{2}{3} + \beta_1}}
\end{equation}

When $\dfrac{\beta_2}{\frac{2}{3} + \beta_1} \le 1$ we have

\begin{equation}
u_0 -  \sqrt{gh_0} \le  v^-_p \le u_0 - \sqrt{gh_0} \sqrt{\dfrac{\beta_2}{\frac{2}{3} + \beta_1}} \le u_0 \le u_0 + \sqrt{gh_0} \sqrt{\dfrac{\beta_2}{\frac{2}{3} + \beta_1}} \le   v^+_p  \le u_0 +   \sqrt{gh_0}
\end{equation}

(includes Serre and regularised SWWE). For Serre the $k \rightarrow \infty $ bounds are $u_0$, so inequality simplifies for regularised SWWE, phase speed is fixed as $k$ changes. 

when $\dfrac{\beta_2}{\frac{2}{3} + \beta_1} > 1$ we have

\begin{equation}
u_0 - \sqrt{gh_0} \sqrt{\dfrac{\beta_2}{\frac{2}{3} + \beta_1}} \le v^-_p \le u_0 -  \sqrt{gh_0} \le  u_0 \le u_0 + \sqrt{gh_0} \le   v^+_p  \le u_0 +  \sqrt{gh_0} \sqrt{\dfrac{\beta_2}{\frac{2}{3} + \beta_1}}
\end{equation}

Region $1$ is what we expect, dispersive waves travel behind the shock front, Region $2$ is inverted and we begin to see dispersive waves travel in front of the shock. 




\section{Validation}

\subsection{Forced Solution}
To demonstate the validity and versatility of our method to solve the gSGN whilst allowing varying $\beta_i$ values, we make use of forced solutions. To generate a forced solution we consider the modified gSGN equations 

\begin{subequations}
	\begin{gather}
	\dfrac{\partial h}{\partial t} + \dfrac{\partial (uh)}{\partial x} = \dfrac{\partial h^*}{\partial t} + \dfrac{\partial (u^*h^*)}{\partial x} 
	\label{eq:gSGN_Gh_Forced}
	\end{gather}
	\begin{multline}
	\dfrac{\partial G }{\partial t}  + \dfrac{\partial}{\partial x} \left ( uG + \dfrac{gh^2}{2} - \frac{2}{3}\left(1 + \frac{3}{2} \beta_1\right) h^3\dfrac{\partial u}{\partial x}\dfrac{\partial u}{\partial x}  - \frac{1}{2} \beta_2 g h^2  \left[h\frac{\partial^2 h}{\partial x^2} + \frac{1}{2}\frac{\partial h}{\partial x}\frac{\partial h}{\partial x}\right]\right ) = \\ \dfrac{\partial G^* }{\partial t}  + \dfrac{\partial}{\partial x} \left ( u^*G^* + \dfrac{g\left(h^*\right)^2}{2} - \frac{2}{3}\left(1 + \frac{3}{2} \beta_1\right) \left(h^*\right)^3\dfrac{\partial u^*}{\partial x}\dfrac{\partial u^*}{\partial x}  - \frac{1}{2} \beta_2 g \left(h^*\right)^2  \left[h^*\frac{\partial^2 h^*}{\partial x^2} + \frac{1}{2}\frac{\partial h^*}{\partial x}\frac{\partial h^*}{\partial x}\right]\right ) 
	\label{eq:gSGN_GG_Forced}
	\end{multline}
\end{subequations}

which admit the solutions $h^*$, $u^*$ and $G^*$ assuming $G^*$ appropriately satisfies \eqref{eq:G_divergent}. Since these equations are satisfied for any chosen $h^*$, $u^*$ and $G^*$, we can generated any desired solution. Since the left hand-side of these modified equations are approximated by our numerical method, if we combine the numerical method with analytic expressions for the right handside, we have a method that approximates the forced gSGN equation with the same convergence properties as the underlying numerical method for the gSGN equations. 

Since we are free to choose $h^*$, $u^*$ and $G^*$ we can generate solutions and thus test our convergence properties for situations for which no analytic solution to the equations exist, in particular in this paper we are interested in solutions where the $\beta$ values vary in space and time. 

I have used this technique to investigate the method for the following forced solutions

\begin{subequations}
	\begin{equation}
	h^*(x,t) = a_0 + a_1 \exp\left( \dfrac{\left(x - a_2 t\right)^2}{2 a_3} \right)
	\end{equation}
	\begin{equation}
	u^*(x,t) = a_4 \exp\left( \dfrac{\left(x - a_2 t\right)^2}{2 a_3} \right)
	\end{equation}
	\begin{align}
	\beta_1(x,t) &= a_6(x - a_5 t) + a_7 \\
	\beta_2(x,t) &= a_8(x - a_5 t) + a_9
	\end{align}
\end{subequations}
where $G^*$ is determined by \eqref{eq:G_divergent} with the above values. 

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsHInit.tex}
		\caption{$t = 0s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsHEnd.tex}
		\caption{$t = 10s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsUInit.tex}
		\caption{$t = 0s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsUEnd.tex}
		\caption{$t = 10s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsGInit.tex}
		\caption{$t = 0s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsGEnd.tex}
		\caption{$t = 10s$}
	\end{subfigure}
	\caption{$\Delta x = 0.0469 m$. }
\end{figure}
\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsBeta1.tex}
		\caption{$\beta_1$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/ForcedSolution/ExampleResultsBeta2.tex}
		\caption{$\beta_2$}
	\end{subfigure}
\end{figure}

\begin{figure}
	\centering
	\input{./Figures/ForcedSolution/NormResults.tex}
	\caption{$L_2$ comparing numerical solution and forced soluiton}
\end{figure}


\subsection{Analytic Solution}
\subsubsection{Solitary Travelling Wave - Serre ($\beta_1=\beta_2 =0$) }
When $\beta_1 = \beta_2 = 0$ the gSGN are equivalent to the SGN equations which admit the following travelling wave solution

\begin{subequations}
	\begin{equation}
	h(x,t) = a_0 + a_1 \text{sech}^2\left( \kappa (x - ct) \right)
	\end{equation}
	\begin{equation}
	u(x,t) = c \left( 1- \dfrac{a_0}{h(x,t)} \right)
	\end{equation}
	where
	\begin{equation}
	\kappa = \dfrac{\sqrt{3a_1}}{2a_0 \sqrt{a_0 + a_1}}
	\end{equation}
	\begin{equation}
	c = \sqrt{g\left(a_0 + a_1\right)}
	\end{equation}
\end{subequations}

\begin{figure}
	\tikzset{every picture/.style={scale=0.9}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsHInit.tex}
	\caption{$t = 0s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsHEnd.tex}
	\caption{$t = 10s$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsUInit.tex}
	\caption{$t = 0s$}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsUEnd.tex}
	\caption{$t = 10s$}
\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsGInit.tex}
	\caption{$t = 0s$}
\end{subfigure}
\begin{subfigure}{0.49\textwidth}
	\centering
	\input{./Figures/Soliton/ExampleResultsGEnd.tex}
	\caption{$t = 10s$}
\end{subfigure}
	\caption{$\Delta x = 0.0234 m$. }
\end{figure}

\begin{figure}
	\centering
	\input{./Figures/Soliton/NormResults.tex}
	\caption{$L_2$ norm comparing numerical solution and analytic solution for travelling wave solution with $\beta_1 = \beta_2 = 0$. }
\end{figure}

\begin{figure}
	\centering
	\input{./Figures/Soliton/EnergyResults.tex}
	\caption{$C$ comparing total amount of conserved quantities in initial conditions and numerical solution for travelling wave solution with $\beta_1 = \beta_2 = 0$. }
\end{figure}


\subsubsection{Dam-break - SWWE ( $\beta_1= -\frac{2}{3}$ and $ \beta_2 =0$ ) }
\begin{align}
h(x,0) & = \left\lbrace \begin{array}{c c}
h_0 & x < 0\\
h_1 & x \ge 0
\end{array} \right.  \\
u(x,0) &= 0 \\
G(x,0) &= 0
\end{align}
$\Delta x \approx 0.02$
\begin{figure}
	\tikzset{every picture/.style={scale=0.6}}%
	\centering
	\begin{subfigure}{0.3\textwidth}
		\centering
		\input{./Figures/Dambreak/DBInith.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.3\textwidth}
		\centering
		\input{./Figures/Dambreak/DBInitu.tex}
		\caption{$u$}
	\end{subfigure}
	\begin{subfigure}{0.3\textwidth}
		\centering
		\input{./Figures/Dambreak/DBInitG.tex}
		\caption{$G$}
	\end{subfigure}
	\caption{Initial Conditions}
\end{figure}

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/Dambreak/DBEndh.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/Dambreak/DBEndu.tex}
		\caption{$u$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/Dambreak/DBEndG.tex}
		\caption{$G$}
	\end{subfigure}
	\caption{Numerical Solution}
\end{figure}
\begin{table}
\begin{tabular}{c c c c c}
Context	 & $h$ & $G$ & $uh$ & $\mathcal{H}$ \\
\hline
Initial	& $300.032154872864$ & $0$ & $0$ & $2452.77542969807$ \\
End	& $300.03215487288$ & $220.741414068836$ & $220.741410229554$ & $2442.82816385916$ \\
Analytic Flux & $0$ & $220.741414068868$& $220.741414068868$ & $0$ \\
Conservation Error &  $5.342708725849857 \times 10^{-14}$ & $3.200284481863491\times 10^{-11}$ 
 & $3.839314018705409\times 10^{-6}$ & $0.004055514303702256$
\end{tabular}
\caption{Conservation error for gSGN solver dam-break solution}
\end{table}


\subsection{Numerical Experiments}

\subsubsection{Smooth Dambreak}

\begin{align}
h(x,0) & = h_0 + \dfrac{h_1 - h_0}{2} \left(1 + \tanh\left(\dfrac{x}{\alpha}\right)\right)  \\
u(x,0) &= 0 \\
G(x,0) &= 0
\end{align}

$\alpha = 2$

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2Inith.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2Inithz.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2Initu.tex}
		\caption{$u$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2InitG.tex}
		\caption{$G$}
	\end{subfigure}
	\caption{Initial Conditions $\alpha = 2$}
\end{figure}


\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2ImpDisph.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2ImpDisphz.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2ImpDispu.tex}
		\caption{$u$}
	\end{subfigure}
	\caption{Improve Dispersion Serre Family $\beta_1 = \beta_2$ for smooth dam-break $\alpha = 2$ at $t=15s$. $\beta_1 =\beta_2 = 0.1$ to $\beta_1 =\beta_2 = 1$. }
\end{figure}

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2RegSWWEh.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2RegSWWEu.tex}
		\caption{$u$}
	\end{subfigure}
	\caption{Regularised SWWE Family $\beta_1 = \beta_2 - \frac{2}{3}$ for smooth dam-break $\alpha = 2$ at $t=15s$. $\beta_1 = \beta_2 - \frac{2}{3}$ with  $\beta_2 = 0$ to $\beta_2 = 5$. }
\end{figure}

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2Reg2h.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a2/SDBa2Reg2u.tex}
		\caption{$u$}
	\end{subfigure}
	\caption{Region 2 Family $\beta_1 = \beta_2 - \frac{2}{3} - k$ and $\beta_2 = 2k$ (should find something better so we get expanding wave train), so $\alpha = 2$ for smooth dam-break $\alpha = 2$ at $t=15s$.  }
\end{figure}


$\alpha = 0.1$

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1Inith.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1Inithz.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1Initu.tex}
		\caption{$u$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1InitG.tex}
		\caption{$G$}
	\end{subfigure}
	\caption{Initial Conditions $\alpha = 0.1$}
\end{figure}

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1ImpDisph.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1ImpDisphz.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1ImpDispu.tex}
		\caption{$u$}
	\end{subfigure}
	\caption{Improve Dispersion Serre Family $\beta_1 = \beta_2$ for smooth dam-break $\alpha = 0.1$ at $t=15s$. $\beta_1 =\beta_2 = 0.1$ to $\beta_1 =\beta_2 = 1$. }
\end{figure}

\begin{figure}
	\tikzset{every picture/.style={scale=0.75}}%
	\centering
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1RegSWWEh.tex}
		\caption{$h$}
	\end{subfigure}
	\begin{subfigure}{0.49\textwidth}
		\centering
		\input{./Figures/SmoothDB-a0p1/SDBa0p1RegSWWEu.tex}
		\caption{$u$}
	\end{subfigure}
	\caption{Improve Dispersion Serre Family $\beta_1 = \beta_2$ for smooth dam-break $\alpha = 2$ at $t=15s$. $\beta_1 = \beta_2 - \frac{2}{3}$ with  $\beta_2 = 0$ to $\beta_2 = 5$. }
\end{figure}

%-----------------------------------------------------
\begin{thebibliography}{99}
%-----------------------------------------------------

\bibitem{Clamond-Dutykh-2018-237}Clamond,~D. and D.~Dutykh, Non-dispersive conservative regularisation of nonlinear shallow water (and isentropic Euler equations), Communications in Nonlinear Science and Numerical Simulation, 55(42), 237-247.

\bibitem{Dutykh-etal-2018-371}Dutykh,~D., M.~Hoefer and D.~Mitsotakis, Soliary wave solutions and their interactions for fully nonlinear water waves with surface tension in the generalized Serre equations, Theoretical and Computational Fluid Dynamics, 32(3), 371-397.

\bibitem{Evans-L-1997} L.C.~Evans, \emph{Partial Differential Equations}, Graduate Studies in Mathematics, Volume 19, American Mathematical Society, New York, (1997).

\bibitem{Harten-A-83-357}  A.~Harten, High resolution schemes for hyperbolic conservation laws, Journal of Computational Physics,  49 (3) (1983) 357-393.

\bibitem{Kurganov-etal-2001-707} A.~Kurganov, S.~Noelle, G.~Petrova, Semidiscrete central-upwind schemes for hyperbolic conservation laws and Hamilton-Jacobi equations, Journal of Scientific Computing, Society for Industrial and Applied Mathematics, 23 (3) (2002) 707-740.

\bibitem{vanLeer-B-1979-101} B.~van~Leer, Towards the ultimate conservative difference scheme, V. A second-order sequel to Godunov's method, Journal of Computational Physics, 32 (1) (1979) 101-136.

\bibitem{Shu-Osher-1988-439} C.W.~Shu, S.~Osher, Efficient implementation of essentially non-oscillatory shock-capturing schemes, Journal of Computational Physics,  77 (2) (1988) 439-471.

\bibitem{Serre-F-1953-857} F.~Serre, Contribution \`{a} l'\'{e}tude des \'{e}coulements permanents et variables dans les canaux, La Houille Blanche, 6 (1953) 830-872.

\bibitem{Zoppou-C-2014} C.~Zoppou, Numerical solution of the one-dimensional and cylindrical Serre equations for rapidly varying free surface flows, Ph.D., Mathematical Sciences Institute, College of Physical and Mathematical Sciences, The Australian National University, (2014).

\bibitem{Zoppou-etal-2017-70}C.~Zoppou, J.~Pitt and S.G.~Roberts, Numerical solution of the fully non-linear weakly dispersive Serre equations for steep gradient flows, Applied Mathematical Modelling, 48, 70-95.

\end{thebibliography}

\end{document} 